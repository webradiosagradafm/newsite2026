<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="manifest" href="/manifest.json">
    <title>Praise FM USA</title>
    <style>
        body, html { margin: 0; padding: 0; background: #000; font-family: sans-serif; }
        
        /* INTERFACE DO SITE (VISÍVEL NO NAVEGADOR) */
        #standard-site-interface { display: block; color: white; text-align: center; padding-top: 50px; }
        .install-banner { background: #ff6600; padding: 20px; position: fixed; top: 0; width: 100%; z-index: 100; }

        /* INTERFACE DO APP (SÓ NO MODO STANDALONE) */
        #pwa-app-interface { display: none; background: #000; min-height: 100vh; }
        .app-header { text-align: center; padding: 30px 0; }
        .bbc-carousel { display: flex; overflow-x: auto; gap: 15px; padding: 20px; scrollbar-width: none; }
        .bbc-carousel::-webkit-scrollbar { display: none; }
        .bbc-item { flex: 0 0 115px; text-align: center; color: white; }
        .circle-wrap { width: 100px; height: 100px; border-radius: 50%; margin: 0 auto 10px; padding: 3px; background: #333; position: relative; }
        .is-live .circle-wrap { background: linear-gradient(180deg, #ff6600, #ffcc00); }
        .circle-wrap img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; border: 3px solid #000; }
        .live-badge { display: none; position: absolute; bottom: -5px; left: 50%; transform: translateX(-50%); background: #ff6600; font-size: 10px; padding: 2px 6px; border-radius: 4px; font-weight: bold; }
        .is-live .live-badge { display: block; }
    </style>
</head>
<body>

    <div id="standard-site-interface">
        <div id="install-banner" class="install-banner" style="display:none;">
            <span>Install the Praise FM App for a better experience!</span>
            <button onclick="installApp()" style="margin-left:15px; padding: 8px 16px; border-radius: 20px; border:none; font-weight:bold;">INSTALL</button>
        </div>
        <h1>Praise FM USA Website</h1>
        <p>Visit us on your mobile browser to install our custom app interface.</p>
    </div>

    <div id="pwa-app-interface">
        <div class="app-header">
            <img src="/logo.png" alt="Praise FM" style="height: 50px;">
        </div>
        <div class="bbc-carousel" id="dynamicCarousel"></div>
        <div style="text-align:center; margin-top:50px;">
            <button style="background:#ff6600; color:white; border:none; padding:15px 50px; border-radius:30px; font-weight:bold;">PLAY LIVE</button>
        </div>
    </div>

    <script>
        const schedule = [
            { s: 0, e: 6, display: "12:00 AM - 06:00 AM", name: "Midnight Grace", host: "Daniel Brooks", img: "daniel.jpg" }, // 
            { s: 6, e: 7, display: "06:00 AM - 07:00 AM", name: "Praise FM Worship", host: "Worship", img: "worship.jpg" }, // 
            { s: 7, e: 12, display: "07:00 AM - 12:00 PM", name: "Morning Show", host: "Stancy Cambpell", img: "stancy.jpg" }, // 
            { s: 12, e: 13, display: "12:00 PM - 01:00 PM", name: "Praise FM Worship", host: "Worship", img: "worship.jpg" }, // 
            { s: 13, e: 16, display: "01:00 PM - 04:00 PM", name: "Midday Grace", host: "Michael Ray", img: "michael.jpg" }, // 
            { s: 21, e: 22, display: "09:00 PM - 10:00 PM", name: "Classics", host: "Scott Turner", img: "scott.jpg" } // 
        ];

        function checkDisplayMode() {
            const isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;
            if (isStandalone) {
                document.getElementById('pwa-app-interface').style.display = 'block';
                document.getElementById('standard-site-interface').style.display = 'none';
                renderApp();
            }
        }

        function renderApp() {
            const container = document.getElementById('dynamicCarousel');
            const chicagoHour = parseInt(new Intl.DateTimeFormat("en-US", {timeZone: "America/Chicago", hour: "numeric", hour12: false}).format(new Date()));

            container.innerHTML = schedule.map(item => {
                const isLive = chicagoHour >= item.s && chicagoHour < item.e;
                return `
                    <div class="bbc-item ${isLive ? 'is-live' : ''}">
                        <div class="circle-wrap">
                            <img src="/images/${item.img}" onerror="this.src='/images/default.jpg'">
                            <div class="live-badge">LIVE</div>
                        </div>
                        <div style="font-size:12px; font-weight:bold;">${item.name}</div>
                        <div style="font-size:10px; color:#888;">${item.display}</div>
                    </div>`;
            }).join('');
        }

        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('install-banner').style.display = 'block';
        });

        async function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt = null;
            }
        }

        window.onload = checkDisplayMode;
    </script>
</body>
</html>